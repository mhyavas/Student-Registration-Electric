{"version":3,"sources":["user/demo_todomvc_composed.cljc"],"mappings":";AAQA,AAEA,AAWA","names":[],"sourcesContent":["(ns user.demo-todomvc-composed\r\n  (:require\r\n    #?(:clj [datomic.api :as d])\r\n    [hyperfiddle.electric :as e]\r\n    [hyperfiddle.electric-dom2 :as dom]\r\n    [hyperfiddle.electric-ui4 :as ui]\r\n    [user.demo-todomvc :as todomvc]))\r\n\r\n(def !n #?(:clj (atom 1)))\r\n\r\n(e/defn PopoverCascaded [i F]\r\n  (let [!focused (atom false) focused (e/watch !focused)]\r\n    (dom/div (dom/props {:style {:position \"absolute\"\r\n                                 :width \"50vw\"\r\n                                 :left (str (* i 40) \"px\")\r\n                                 :top (str (-> i (* 40) (+ 60)) \"px\")\r\n                                 :z-index (+ i (if focused 1000 0))}})\r\n      (dom/on \"mouseenter\" (e/fn [_] (reset! !focused true)))\r\n      (dom/on \"mouseleave\" (e/fn [_] (reset! !focused false)))\r\n      (F.))))\r\n\r\n(e/defn TodoMVC-composed []\r\n  (e/client\r\n    (let [state (e/watch todomvc/!state)\r\n          n (e/server (e/watch !n))]\r\n      (e/server\r\n        (binding [todomvc/db (e/watch todomvc/!db)\r\n                  todomvc/transact! (partial d/transact todomvc/!conn)]\r\n          (e/client\r\n            (dom/link (dom/props {:rel :stylesheet, :href \"/todomvc.css\"}))\r\n            (ui/range n (e/fn [v] (e/server (reset! !n v)))\r\n              (dom/props {:min 1 :max 25 :step 1}))\r\n            (dom/div (dom/props {:class \"todomvc\" :style {:position \"relative\"}})\r\n              (dom/h1 (dom/text \"TodoMVC\"))\r\n\r\n              (e/for [i (range n)] ; <<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<\r\n                (PopoverCascaded. i\r\n                  (e/fn [] (todomvc/TodoMVC-UI. state)))))))))))\r\n"]}